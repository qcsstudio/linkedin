// File: src/app/api/format/route.js
import { NextResponse } from 'next/server';
// â€”â€”â€”â€”â€” Unicode Maps â€”â€”â€”â€”â€”
// Bold
const BOLD_MAP = {
  A:'ð—”',B:'ð—•',C:'ð—–',D:'ð——',E:'ð—˜',F:'ð—™',G:'ð—š',H:'ð—›',I:'ð—œ',
  J:'ð—',K:'ð—ž',L:'ð—Ÿ',M:'ð— ',N:'ð—¡',O:'ð—¢',P:'ð—£',Q:'ð—¤',R:'ð—¥',
  S:'ð—¦',T:'ð—§',U:'ð—¨',V:'ð—©',W:'ð—ª',X:'ð—«',Y:'ð—¬',Z:'ð—­',
  a:'ð—®',b:'ð—¯',c:'ð—°',d:'ð—±',e:'ð—²',f:'ð—³',g:'ð—´',h:'ð—µ',i:'ð—¶',
  j:'ð—·',k:'ð—¸',l:'ð—¹',m:'ð—º',n:'ð—»',o:'ð—¼',p:'ð—½',q:'ð—¾',r:'ð—¿',
  s:'ð˜€',t:'ð˜',u:'ð˜‚',v:'ð˜ƒ',w:'ð˜„',x:'ð˜…',y:'ð˜†',z:'ð˜‡',
  0:'ðŸ¬',1:'ðŸ­',2:'ðŸ®',3:'ðŸ¯',4:'ðŸ°',5:'ðŸ±',6:'ðŸ²',7:'ðŸ³',8:'ðŸ´',9:'ðŸµ'
};
// Italic
const ITALIC_MAP = {
  A:'ð˜ˆ',B:'ð˜‰',C:'ð˜Š',D:'ð˜‹',E:'ð˜Œ',F:'ð˜',G:'ð˜Ž',H:'ð˜',I:'ð˜',
  J:'ð˜‘',K:'ð˜’',L:'ð˜“',M:'ð˜”',N:'ð˜•',O:'ð˜–',P:'ð˜—',Q:'ð˜˜',R:'ð˜™',
  S:'ð˜š',T:'ð˜›',U:'ð˜œ',V:'ð˜',W:'ð˜ž',X:'ð˜Ÿ',Y:'ð˜ ',Z:'ð˜¡',
  a:'ð˜¢',b:'ð˜£',c:'ð˜¤',d:'ð˜¥',e:'ð˜¦',f:'ð˜§',g:'ð˜¨',h:'ð˜©',i:'ð˜ª',
  j:'ð˜«',k:'ð˜¬',l:'ð˜­',m:'ð˜®',n:'ð˜¯',o:'ð˜°',p:'ð˜±',q:'ð˜²',r:'ð˜³',
  s:'ð˜´',t:'ð˜µ',u:'ð˜¶',v:'ð˜·',w:'ð˜¸',x:'ð˜¹',y:'ð˜º',z:'ð˜»'
};
// Bold + Italic (Mathematical Bold Italic)
const BOLD_ITALIC_MAP = {
  A:'ð‘¨',B:'ð‘©',C:'ð‘ª',D:'ð‘«',E:'ð‘¬',F:'ð‘­',G:'ð‘®',H:'ð‘¯',I:'ð‘°',
  J:'ð‘±',K:'ð‘²',L:'ð‘³',M:'ð‘´',N:'ð‘µ',O:'ð‘¶',P:'ð‘·',Q:'ð‘¸',R:'ð‘¹',
  S:'ð‘º',T:'ð‘»',U:'ð‘¼',V:'ð‘½',W:'ð‘¾',X:'ð‘¿',Y:'ð’€',Z:'ð’',
  a:'ð’‚',b:'ð’ƒ',c:'ð’„',d:'ð’…',e:'ð’†',f:'ð’‡',g:'ð’ˆ',h:'ð’‰',i:'ð’Š',
  j:'ð’‹',k:'ð’Œ',l:'ð’',m:'ð’Ž',n:'ð’',o:'ð’',p:'ð’‘',q:'ð’’',r:'ð’“',
  s:'ð’”',t:'ð’•',u:'ð’–',v:'ð’—',w:'ð’˜',x:'ð’™',y:'ð’š',z:'ð’›'
};
// Script (Cursive)
const SCRIPT_MAP = {
  A:'ð“',B:'ð“‘',C:'ð“’',D:'ð““',E:'ð“”',F:'ð“•',G:'ð“–',H:'ð“—',I:'ð“˜',
  J:'ð“™',K:'ð“š',L:'ð“›',M:'ð“œ',N:'ð“',O:'ð“ž',P:'ð“Ÿ',Q:'ð“ ',R:'ð“¡',
  S:'ð“¢',T:'ð“£',U:'ð“¤',V:'ð“¥',W:'ð“¦',X:'ð“§',Y:'ð“¨',Z:'ð“©',
  a:'ð“ª',b:'ð“«',c:'ð“¬',d:'ð“­',e:'ð“®',f:'ð“¯',g:'ð“°',h:'ð“±',i:'ð“²',
  j:'ð“³',k:'ð“´',l:'ð“µ',m:'ð“¶',n:'ð“·',o:'ð“¸',p:'ð“¹',q:'ð“º',r:'ð“»',
  s:'ð“¼',t:'ð“½',u:'ð“¾',v:'ð“¿',w:'ð”€',x:'ð”',y:'ð”‚',z:'ð”ƒ'
};
// Monospace
const MONOSPACE_MAP = {
  A:'ð™°',B:'ð™±',C:'ð™²',D:'ð™³',E:'ð™´',F:'ð™µ',G:'ð™¶',H:'ð™·',I:'ð™¸',
  J:'ð™¹',K:'ð™º',L:'ð™»',M:'ð™¼',N:'ð™½',O:'ð™¾',P:'ð™¿',Q:'ðš€',R:'ðš',
  S:'ðš‚',T:'ðšƒ',U:'ðš„',V:'ðš…',W:'ðš†',X:'ðš‡',Y:'ðšˆ',Z:'ðš‰',
  a:'ðšŠ',b:'ðš‹',c:'ðšŒ',d:'ðš',e:'ðšŽ',f:'ðš',g:'ðš',h:'ðš‘',i:'ðš’',
  j:'ðš“',k:'ðš”',l:'ðš•',m:'ðš–',n:'ðš—',o:'ðš˜',p:'ðš™',q:'ðšš',r:'ðš›',
  s:'ðšœ',t:'ðš',u:'ðšž',v:'ðšŸ',w:'ðš ',x:'ðš¡',y:'ðš¢',z:'ðš£',
  0:'ðŸ¶',1:'ðŸ·',2:'ðŸ¸',3:'ðŸ¹',4:'ðŸº',5:'ðŸ»',6:'ðŸ¼',7:'ðŸ½',8:'ðŸ¾',9:'ðŸ¿'
};
// Small Caps (cover both cases)
const SMALL_CAPS_MAP = {
  A:'á´€',B:'Ê™',C:'á´„',D:'á´…',E:'á´‡',F:'êœ°',G:'É¢',H:'Êœ',I:'Éª',
  J:'á´Š',K:'á´‹',L:'ÊŸ',M:'á´',N:'É´',O:'á´',P:'á´˜',Q:'Ç«',R:'Ê€',
  S:'s',T:'á´›',U:'á´œ',V:'á´ ',W:'á´¡',X:'x',Y:'Ê',Z:'á´¢',
  a:'á´€',b:'Ê™',c:'á´„',d:'á´…',e:'á´‡',f:'êœ°',g:'É¢',h:'Êœ',i:'Éª',
  j:'á´Š',k:'á´‹',l:'ÊŸ',m:'á´',n:'É´',o:'á´',p:'á´˜',q:'Ç«',r:'Ê€',
  s:'s',t:'á´›',u:'á´œ',v:'á´ ',w:'á´¡',x:'x',y:'Ê',z:'á´¢'
};
// Double-Struck (Outline)
const DOUBLE_STRUCK_MAP = {
  A:'ð”¸',B:'ð”¹',C:'â„‚',D:'ð”»',E:'ð”¼',F:'ð”½',G:'ð”¾',H:'â„',I:'ð•€',
  J:'ð•',K:'ð•‚',L:'ð•ƒ',M:'ð•„',N:'â„•',O:'ð•†',P:'â„™',Q:'â„š',R:'â„',
  S:'ð•Š',T:'ð•‹',U:'ð•Œ',V:'ð•',W:'ð•Ž',X:'ð•',Y:'ð•',Z:'â„¤',
  a:'ð•’',b:'ð•“',c:'ð•”',d:'ð••',e:'ð•–',f:'ð•—',g:'ð•˜',h:'ð•™',i:'ð•š',
  j:'ð•›',k:'ð•œ',l:'ð•',m:'ð•ž',n:'ð•Ÿ',o:'ð• ',p:'ð•¡',q:'ð•¢',r:'ð•£',
  s:'ð•¤',t:'ð•¥',u:'ð•¦',v:'ð•§',w:'ð•¨',x:'ð•©',y:'ð•ª',z:'ð•«',
  0:'ðŸ˜',1:'ðŸ™',2:'ðŸš',3:'ðŸ›',4:'ðŸœ',5:'ðŸ',6:'ðŸž',7:'ðŸŸ',8:'ðŸ ',9:'ðŸ¡'
};
// Fraktur (Gothic)
const FRAKTUR_MAP = {
  A:'ð”„',B:'ð”…',C:'â„­',D:'ð”‡',E:'ð”ˆ',F:'ð”‰',G:'ð”Š',H:'â„Œ',I:'â„‘',
  J:'ð”',K:'ð”Ž',L:'ð”',M:'ð”',N:'ð”‘',O:'ð”’',P:'ð”“',Q:'ð””',R:'â„œ',
  S:'ð”–',T:'ð”—',U:'ð”˜',V:'ð”™',W:'ð”š',X:'ð”›',Y:'ð”œ',Z:'â„¨',
  a:'ð”ž',b:'ð”Ÿ',c:'ð” ',d:'ð”¡',e:'ð”¢',f:'ð”£',g:'ð”¤',h:'ð”¥',i:'ð”¦',
  j:'ð”§',k:'ð”¨',l:'ð”©',m:'ð”ª',n:'ð”«',o:'ð”¬',p:'ð”­',q:'ð”®',r:'ð”¯',
  s:'ð”°',t:'ð”±',u:'ð”²',v:'ð”³',w:'ð”´',x:'ð”µ',y:'ð”¶',z:'ð”·'
};
// Squared / Parenthesized (Letters only)
const SQUARED_MAP = {
  A:'ðŸ„°',B:'ðŸ„±',C:'ðŸ„²',D:'ðŸ„³',E:'ðŸ„´',F:'ðŸ„µ',G:'ðŸ„¶',H:'ðŸ„·',I:'ðŸ„¸',
  J:'ðŸ„¹',K:'ðŸ„º',L:'ðŸ„»',M:'ðŸ„¼',N:'ðŸ„½',O:'ðŸ„¾',P:'ðŸ„¿',Q:'ðŸ…€',R:'ðŸ…',
  S:'ðŸ…‚',T:'ðŸ…ƒ',U:'ðŸ…„',V:'ðŸ……',W:'ðŸ…†',X:'ðŸ…‡',Y:'ðŸ…ˆ',Z:'ðŸ…‰',
  a:'ðŸ„°',b:'ðŸ„±',c:'ðŸ„²',d:'ðŸ„³',e:'ðŸ„´',f:'ðŸ„µ',g:'ðŸ„¶',h:'ðŸ„·',i:'ðŸ„¸',
  j:'ðŸ„¹',k:'ðŸ„º',l:'ðŸ„»',m:'ðŸ„¼',n:'ðŸ„½',o:'ðŸ„¾',p:'ðŸ„¿',q:'ðŸ…€',r:'ðŸ…',
  s:'ðŸ…‚',t:'ðŸ…ƒ',u:'ðŸ…„',v:'ðŸ……',w:'ðŸ…†',x:'ðŸ…‡',y:'ðŸ…ˆ',z:'ðŸ…‰'
};
// Subscript
const SUBSCRIPT_MAP = {
  '0':'â‚€','1':'â‚','2':'â‚‚','3':'â‚ƒ','4':'â‚„','5':'â‚…','6':'â‚†','7':'â‚‡','8':'â‚ˆ','9':'â‚‰',
  a:'â‚',e:'â‚‘',i:'áµ¢',o:'â‚’',r:'áµ£',u:'áµ¤',v:'áµ¥',x:'â‚“',y:'áµ§'
};
// Superscript
const SUPERSCRIPT_MAP = {
  '0':'â°','1':'Â¹','2':'Â²','3':'Â³','4':'â´','5':'âµ','6':'â¶','7':'â·','8':'â¸','9':'â¹',
  a:'áµƒ',b:'áµ‡',c:'á¶œ',d:'áµˆ',e:'áµ‰',f:'á¶ ',g:'áµ',h:'Ê°',i:'â±',j:'Ê²',
  k:'áµ',l:'Ë¡',m:'áµ',n:'â¿',o:'áµ’',p:'áµ–',r:'Ê³',s:'Ë¢',t:'áµ—',u:'áµ˜',
  v:'áµ›',w:'Ê·',x:'Ë£',y:'Ê¸',z:'á¶»'
};
// â€”â€”â€”â€”â€” Transformer â€”â€”â€”â€”â€”
function transformText(text, style) {
  switch (style) {
    case 'bold':         return [...text].map(c => BOLD_MAP[c]        || c).join('');
    case 'italic':       return [...text].map(c => ITALIC_MAP[c]      || c).join('');
    case 'bolditalic':   return [...text].map(c => BOLD_ITALIC_MAP[c] || c).join('');
    case 'underline':    return [...text].map(c => c + '\u0332').join('');
    case 'strikethrough':return [...text].map(c => c + '\u0336').join('');
    case 'script':       return [...text].map(c => SCRIPT_MAP[c]      || c).join('');
    case 'monospace':    return [...text].map(c => MONOSPACE_MAP[c]   || c).join('');
    case 'smallcaps':    return [...text].map(c => SMALL_CAPS_MAP[c]  || c).join('');
    case 'doublestruck': return [...text].map(c => DOUBLE_STRUCK_MAP[c]|| c).join('');
    case 'fraktur':      return [...text].map(c => FRAKTUR_MAP[c]     || c).join('');
    case 'squared':      return [...text].map(c => SQUARED_MAP[c]     || c).join('');
    case 'subscript':    return [...text].map(c => SUBSCRIPT_MAP[c]    || c).join('');
    case 'superscript':  return [...text].map(c => SUPERSCRIPT_MAP[c]  || c).join('');
    default:             return text;
  }
}
// â€”â€”â€”â€”â€” API Handler â€”â€”â€”â€”â€”
export async function POST(req) {
  const { text = '', style = 'bold' } = await req.json();
  return NextResponse.json({ styled: transformText(text, style) });
}
